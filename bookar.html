<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Apothecary AR</title>
    <!-- A-Frame core lib -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <!-- AR.js library for A-Frame -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://unpkg.com/aframe-animation-component@5.1.2/files/dist/aframe-animation-component.js"></script>

    <style>
      #back, #hint {
        z-index: 9999;
        pointer-events: auto;
      }

      a-scene, a-scene canvas {
        position: relative;
        z-index: 1;
      }
    </style>
  </head>
  <body style="margin: 0; overflow: hidden">
    <a href="index.html" style="text-decoration: none;">
      <div id="back" style="position: fixed;
        top: 0.75rem;
        left: 0.75rem;
        background: rgba(255, 255, 255, 0.85);
        color: #333;
        border: none;
        border-radius: 6px;
        padding: 0.4rem 0.7rem;
        font-weight: 700;
        font-size: 0.9rem;
        text-decoration: none;
        z-index: 10;
        font-family: 'Lato', sans-serif;">&larr;&nbsp;Back</div>
    </a>
    <div id="hint" style="position: fixed;
        bottom: 1rem;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(255, 255, 255, 0.85);
        color: #333;
        border-radius: 6px;
        padding: 0.4rem 0.7rem;
        font-size: 0.9rem;
        z-index: 10;
        max-width: 90%;
        text-align: center;
        font-family: 'Lato', sans-serif;">
      Point your camera at the printed marker
    </div>

    <!-- AR scene -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false" vr-mode-ui="enabled: false;">
        <!-- point light -->
        <a-entity light="type: point; intensity: 1.2; decay: 2" position="2 4 2"></a-entity>
        <!-- ambient light -->
        <a-entity light="type: ambient; intensity: 0.3"></a-entity>

        <!-- HIRO marker with peppermint candy + text box -->
        <a-marker preset="hiro">
            <!-- Peppermint Candy Model -->
            <a-entity
              id="peppermint"
              gltf-model="./peppermint_candy/scene.gltf"
              scale="0.2 0.2 0.2"
              position="0 0.75 0"
              animation__rotate="property: rotation; to: 0 360 0; dur: 5000; loop: true; easing: linear"
              animation__bounce="property: scale; dir: alternate; dur: 300; easing: easeOutElastic;
                                 to: 0.28 0.28 0.28; startEvents: bounce"
            ></a-entity>

            <!-- Text Box Background -->
            <a-entity
              geometry="primitive: plane; width: 1.5; height: 0.9"
              material="color: #ffffff; opacity: 0.85; side: double"
              position="1.2 1 0"
            ></a-entity>

            <!-- Text -->
            <a-entity
              position="1.2 1 0.01" 
              scale="1 1 1"
              text="value: Peppermint candy was used to aid in digestion for hundreds of years.;
                    width: 1.4;
                    align: left;
                    color: #333333;
                    wrapCount: 40;
                    side: double">
            </a-entity>
        </a-marker>

        <!-- Empty kanji marker -->
        <a-marker preset="kanji">
            <!-- Placeholder for other models -->
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
    const hint = document.getElementById('hint');
        document.querySelectorAll('a-marker').forEach(marker => {
            marker.addEventListener('markerFound', () => hint.style.display = 'none');
            marker.addEventListener('markerLost', () => hint.style.display = 'flex');
        });
    </script>
  </body>
</html>